<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerenciar Professores</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="assets/css/gerenciar-professores.css">
</head>
<body>
<div class="container">
    <h1>Gerenciar Professores</h1>
    <table id="professoresTable">
        <thead>
            <tr>
                <th>Nome</th>
                <th>Email</th>
                <th>Telefone</th>
                <th>Status</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            <!-- Professores serão carregados aqui -->
        </tbody>
    </table>
</div>

<script type="module">
import { initializeApp } from "./assets/js/firebase-config.js";
import { getFirestore, collection, getDocs, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const app = initializeApp();
const db = getFirestore(app);

async function loadProfessores() {
    const snapshot = await getDocs(collection(db, "professores"));
    const tbody = document.querySelector("#professoresTable tbody");
    tbody.innerHTML = "";

    snapshot.forEach((docSnap) => {
        const p = docSnap.data();
        const tr = document.createElement("tr");

        tr.innerHTML = `
            <td>${p.nomeCompleto}</td>
            <td>${p.email}</td>
            <td>${p.telefone}</td>
            <td>
                <select class="statusSelect" data-id="${docSnap.id}">
                    <option value="ativo" ${p.status === "ativo" ? "selected" : ""}>Ativo</option>
                    <option value="inativo" ${p.status === "inativo" ? "selected" : ""}>Inativo</option>
                </select>
            </td>
            <td>
                <button class="deleteBtn" data-id="${docSnap.id}">Excluir</button>
            </td>
        `;
        tbody.appendChild(tr);
    });

    // Adicionar evento para atualizar status
    document.querySelectorAll(".statusSelect").forEach(select => {
        select.addEventListener("change", async (e) => {
            const id = e.target.dataset.id;
            const novoStatus = e.target.value;
            await updateDoc(doc(db, "professores", id), { status: novoStatus });
            alert("Status atualizado!");
        });
    });

    // Adicionar evento para excluir
    document.querySelectorAll(".deleteBtn").forEach(btn => {
        btn.addEventListener("click", async (e) => {
            const id = e.target.dataset.id;
            if (confirm("Tem certeza que deseja excluir este professor?")) {
                await deleteDoc(doc(db, "professores", id));
                loadProfessores();
            }
        });
    });
}

loadProfessores();
</script>
</body>
</html>
