<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Alunos - AprovaMaisPB</title>
    <script type="module" src="assets/js/firebase-config.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- Aqui você coloca o CSS da lista de alunos --- */
        body { font-family: Arial, sans-serif; background: #f5f7fb; margin:0; }
        .container { max-width: 1200px; margin: auto; padding: 20px; }
        h1 { text-align: center; color: #1a2a6c; margin-bottom: 20px; }
        .search-box { display:flex; margin-bottom: 15px; }
        .search-box input { flex:1; padding:10px; border-radius:5px; border:1px solid #ddd; margin-right:10px; }
        .btn { padding:10px 15px; border:none; border-radius:5px; background:#1a2a6c; color:white; cursor:pointer; }
        table { width:100%; border-collapse: collapse; background:white; border-radius:10px; overflow:hidden; }
        th, td { padding:15px; border-bottom:1px solid #eee; text-align:left; }
        th { background:#1a2a6c; color:white; }
        tr:hover { background:#f9f9f9; }
        .status { padding:5px 10px; border-radius:20px; font-size:12px; font-weight:500; }
        .status.ativo { background:#e8f5e9; color:#2e7d32; }
        .status.inativo { background:#ffebee; color:#d32f2f; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Lista de Alunos</h1>

        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Buscar aluno...">
            <button class="btn" onclick="searchStudents()"><i class="fas fa-search"></i> Buscar</button>
        </div>

        <table id="studentsTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Turma</th>
                    <th>Status</th>
                    <th>Número do Pedido</th>
                    <th>Telefone</th>
                    <th>Email</th>
                </tr>
            </thead>
            <tbody>
                <!-- Alunos serão carregados aqui -->
            </tbody>
        </table>
    </div>

    <script type="module">
        import { initializeApp } from './assets/js/firebase-config.js';
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        const app = initializeApp();
        const db = getFirestore(app);

        async function loadStudents() {
            const tableBody = document.querySelector('#studentsTable tbody');
            tableBody.innerHTML = '';

            try {
                const querySnapshot = await getDocs(collection(db, "inscricoes"));

                querySnapshot.forEach(doc => {
                    const data = doc.data();
                    const row = document.createElement('tr');

                    row.innerHTML = `
                        <td>${doc.id}</td>
                        <td>${data.name || ''}</td>
                        <td>${data.course || ''}</td>
                        <td><span class="status ${data.status === 'confirmado' ? 'ativo' : 'inativo'}">${data.status}</span></td>
                        <td>${data.numeroPedido || ''}</td>
                        <td>${data.phone || ''}</td>
                        <td>${data.email || ''}</td>
                    `;

                    tableBody.appendChild(row);
                });
            } catch (error) {
                console.error("Erro ao carregar alunos:", error);
            }
        }

        function searchStudents() {
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#studentsTable tbody tr');

            rows.forEach(row => {
                const cellsText = Array.from(row.cells).map(cell => cell.textContent.toLowerCase()).join(' ');
                row.style.display = cellsText.includes(searchText) ? '' : 'none';
            });
        }

        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') searchStudents();
        });

        loadStudents();
    </script>
</body>
</html>
